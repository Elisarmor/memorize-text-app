<input type="text" bind:value="sheetUrl" on:change="loadSheet(sheetUrl)">

<p>
	<a href="{ asr.makePath('workbook', { key: '1C6EBjsS-FY6KPzKnHCVFEcpYy_Gh_bvAJWcma50Qwrw' }) }">Try it out</a>
</p>

{#if error}
	<div style="color: red">Error: {error}</div>
{/if}

<script>
import sheetsy from 'sheetsy'

const { urlToKey } = sheetsy

export default {
	data() {
		return {
			sheetUrl: ``,
		}
	},
	methods: {
		loadSheet(url) {
			try {
				const key = urlToKey(url)
				this.fire(`keySelected`, key)
			} catch (error) {
				this.set({
					error,
				})
			}
		},
	},
}
</script>
